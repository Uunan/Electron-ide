<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Güncelleme Kontrolü</title>
    <style>
        :root {
            --bg-medium: #252526; --border-color: #3c3c3c; --text-primary: #e0e0e0;
            --text-secondary: #8e8e8e; --accent-blue: #0e639c; --accent-green: #2e8958;
            --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
        body {
            font-family: var(--font-family); background-color: var(--bg-medium);
            color: var(--text-primary); margin: 0; padding: 2rem;
            text-align: center; user-select: none; overflow: hidden;
            border: 1px solid var(--border-color);
        }
        .status-container { font-size: 1.1rem; }
        .status-container p { margin: 10px 0; }
        .version-info { font-weight: bold; color: var(--accent-green); }
        .error-info { color: #da5851; font-size: 0.9rem; margin-top: 15px; }
        .progress-bar-container { display: none; margin-top: 20px; }
        .progress-bar { height: 10px; background-color: #444; border-radius: 5px; overflow: hidden; }
        .progress-bar-inner { height: 100%; width: 0%; background-color: var(--accent-blue); transition: width 0.2s; }
        .progress-text { font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px; }
        button {
            margin-top: 25px; background: var(--bg-medium); color: var(--text-primary);
            border: 1px solid var(--border-color); padding: 8px 20px; border-radius: 5px;
            cursor: pointer; transition: background-color 0.2s;
        }
        button:hover { background-color: #444; }
    </style>
</head>
<body>
    <div id="status" class="status-container">
        <p id="message">Güncellemeler kontrol ediliyor...</p>
        <p id="details"></p>
        <p class="error-info" id="error-message"></p>
    </div>

    <div class="progress-bar-container" id="progress-container">
        <div class="progress-bar">
            <div class="progress-bar-inner" id="progress-bar-inner"></div>
        </div>
        <div class="progress-text" id="progress-text"></div>
    </div>

    <button id="close-btn" style="display: none;">Kapat</button>

    <script>
        const messageEl = document.getElementById('message');
        const detailsEl = document.getElementById('details');
        const errorEl = document.getElementById('error-message');
        const closeBtn = document.getElementById('close-btn');
        const progressContainer = document.getElementById('progress-container');
        const progressBarInner = document.getElementById('progress-bar-inner');
        const progressText = document.getElementById('progress-text');
        
        // Ana süreçten gelen mesajları dinle
        window.updaterAPI.onUpdateMessage((event, type, data) => {
            switch(type) {
                case 'checking-for-update':
                    messageEl.innerText = 'Güncellemeler kontrol ediliyor...';
                    break;
                case 'update-available':
                    messageEl.innerText = 'Yeni bir güncelleme bulundu!';
                    detailsEl.innerHTML = `Sürüm <span class="version-info">${data.version}</span> indiriliyor...`;
                    progressContainer.style.display = 'block';
                    break;
                case 'update-not-available':
                    messageEl.innerText = 'Uygulamanız güncel!';
                    detailsEl.innerHTML = `Mevcut sürüm: <span class="version-info">${data.version}</span>`;
                    closeBtn.style.display = 'block';
                    break;
                case 'error':
                    messageEl.innerText = 'Güncelleme Hatası';
                    errorEl.innerText = data.message;
                    closeBtn.style.display = 'block';
                    break;
                case 'download-progress':
                    const percent = Math.round(data.percent);
                    progressBarInner.style.width = `${percent}%`;
                    progressText.innerText = `İndirilen: ${percent}%`;
                    break;
                case 'update-downloaded':
                    // Bu mesaj main.js'deki diyalog tarafından yönetildiği için burada bir şey yapmaya gerek yok.
                    // Pencere otomatik kapanacak.
                    break;
            }
        });

        closeBtn.onclick = () => window.updaterAPI.closeUpdateWindow();
    </script>
</body>
</html>